<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- saved from url=(0030)http://www.motherearthnews.com -->
<html><head><!-- Copyright (c) 1998-2006 PHD Computer Consultants Ltd -->



<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="xpsp2_files/phdcc.css" rel="stylesheet" type="text/css"><title>How XP SP2 affects the Local Machine</title>

<meta name="description" content="How Windows XP Service Pack 2 affects web pages running locally on your computer">
<meta name="keywords" content="Windows XP Service Pack 2 SP2 local machine zone My Computer lockdown security active content Java JavaScript ActiveX">
<style media="print" type="text/css">
	.noprint { display:none }
</style>
<script src="xpsp2_files/phdcc.js" type="text/javascript"></script>
<meta></head><body onload="MM_preloadImages('images/learn_hi.gif')">

<!-- Table for all body -->
<table bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0" width="100%">

<!-- Row for heading and menus -->
<tbody><tr>
<td height="157">
	<table class="topTile" border="0" cellpadding="0" cellspacing="0" width="100%">
	<!-- Heading thru to search box -->
	<tbody><tr>
	<td height="117">
		<table border="0" cellpadding="0" cellspacing="0" width="100%">
		<tbody><tr>
		<td align="left" height="117" valign="top" width="317"><img src="xpsp2_files/phdcclogo.jpg" alt="phdcc: e-media tools and e-publishing services for CDs, DVDs and the Web" height="117" width="317"></td>
		<td class="noprint" height="117">&nbsp;</td>
		<td align="right" height="117" valign="top" width="278"><img src="xpsp2_files/topimage.jpg" alt="." height="117" width="278"></td>
		<td class="noprint" align="right" height="117" valign="top" width="165">
			<table border="0" cellpadding="0" cellspacing="0" width="165">
			<tbody><tr>
			<td height="71">
				<input name="cs" value="utf-8" type="hidden">
					<table class="searchBg" border="0" cellpadding="0" cellspacing="0" width="165">
				<tbody><tr>
					<form method="get" action="http://www.phdcc.com/findinsite/search.aspx" style=""></form>
					<td rowspan="2" height="71" width="20">&nbsp;</td>
					<td colspan="2" align="left" height="30" valign="bottom" width="145"><img src="xpsp2_files/search.jpg" alt="search" height="12" width="43"></td>
				</tr>
				<tr>
					<td align="left" height="41" valign="middle" width="110"><input name="Text" class="searchField" type="text"></td>
					<td align="left" height="41" valign="middle" width="35"><input name="GoImage1" id="GoImage1" onmouseover="this.src='images/goBut_hi.gif'" onmouseout="this.src='images/goBut.gif'" src="xpsp2_files/gobut.gif" alt="Start search" type="image" border="0" height="20" width="20"></td>
					
				</tr>
				</tbody></table>
			</td>
			</tr>
			<tr>
			<td align="right" height="46" valign="bottom"><a href="http://www.phdcc.com/fis/"><img src="xpsp2_files/poweredby.jpg" alt="Powered by FindinSite-MS" border="0" height="46" width="165"></a></td>
			</tr>
			</tbody></table>
		</td>
		</tr>
		</tbody></table>
	</td>
	</tr>
	<!-- Top menu -->
	<tr>
	<td align="left" height="36" valign="middle">
		<table border="0" cellpadding="0" cellspacing="0" width="100%">
		<tbody><tr>
		<td class="noprint" height="36" width="32"><img src="xpsp2_files/navleft.jpg" alt="." height="36" width="32"></td>
		<td align="left" height="36" nowrap="nowrap" valign="middle">
			<a href="http://www.phdcc.com/" class="nav1">Home</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/phd.html" class="nav1">About us</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/products.html" class="nav1">Products</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/outlets.html" class="nav1">Buy now</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/design-cd/default.htm" class="nav1">CD Publishing</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/downloads.htm" class="nav1">Downloads</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/comment.htm" class="nav1">Papers</a><span class="navDiv"> | </span>
			<a href="http://www.phdcc.com/feedback.html" class="nav1">Contact us</a>
		</td>
		<td class="noprint" height="36" width="32"><img src="xpsp2_files/topright.jpg" alt="." height="36" width="32"></td>
		</tr>
		</tbody></table>
	</td>
	</tr>
	<!-- Orange line under top menu -->
	<tr class="noprint">
	<td align="left" height="4" valign="top">
		<table border="0" cellpadding="0" cellspacing="0" width="100%">
		<tbody><tr>
		<td align="left" height="4" valign="middle"><img src="xpsp2_files/navunder.gif" alt="." height="4" width="4"></td>
		<td align="right" height="4" valign="top" width="32"><img src="xpsp2_files/orangeright.gif" alt="." height="4" width="32"></td>
		</tr>
		</tbody></table>
	</td>
	</tr>
	</tbody></table>
</td>
</tr>


<!-- Row for main content -->
<tr>
<td>
	<div class="marginContent">
		<table border="0" cellpadding="0" cellspacing="0" width="100%">
		<tbody><tr>
		<td align="left" valign="top">
			<!-- Page heading -->
			<p class="gap">&nbsp;</p>
			<h1>How Windows XP Service Pack 2 affects web pages running locally on your computer</h1>
			<hr>

			<p>
			  <!-- Page content start -->
			  Last modified: 14 October 2005.&nbsp;&nbsp; Any comments or suggestions - <a href="#comments">please fill in form below</a>.  Chris Cant.
			  <br>
			  <font color="gray">Chris is now available for paid-for consultation, software development or web programming - contact us using the form below.</font></p>
			<table align="right" width="130">
<script type="text/javascript"><!--
google_ad_client = "pub-8506256322678700";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "B4D0DC";
google_color_bg = "ECF8FF";
google_color_link = "0000CC";
google_color_url = "008000";
google_color_text = "6F6F6F";
//--></script>
<script type="text/javascript" src="xpsp2_files/show_ads.js">
</script></table>

	<table border="1" bordercolor="red" cellpadding="3" cellspacing="0">
	<tbody><tr><td>
	<b>
	Web pages with active content running locally
	</b>
	<blockquote>
		XP SP2 affects any web page with "active content" running locally on your computer in Internet Explorer.&nbsp;
		Many people provide web page information on CD, provide product documentation as web pages,
		or work with web pages locally before putting them online.&nbsp;
		Even very innocuous JavaScript is deemed to be active content and a user will have to agree to
		very worrying warning messages to see a page - or change a security setting.&nbsp;
		Some valid active content may not work even if the user has enabled active content for the current window.
		<p>
		<a href="#def">See below</a> for screen shots of SP2 when trying to run a Java applet locally.
	</p></blockquote>
	</td></tr>
	</tbody></table>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h2>Web pages on your local computer</h2>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h3>Windows XP SP2 Introduction</h3>

	<blockquote>
		SP2 includes improvements to Internet Explorer security that are intended to help most users
		by stopping local web pages that contain "active content" from accessing your computer maliciously.
		"Active content" includes JavaScript, Java applets and ActiveX controls.
		<p>
		Users and developers of CDs containing our FindinSite-CD applet -
		please read our <a href="http://www.phdcc.com/fiscd/xpsp2.htm">How to run FindinSite-CD in XP SP2</a> instructions.
	</p></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h3>Changes for web pages running locally</h3>

	<blockquote>
		By default in SP2, Internet Explorer will not let any active content run in 
		web pages that run locally (on the Local Machine, ie My Computer).  The user will see a warning message
		in the new yellow Information Bar - clicking in there will let the user "Allow Blocked Content" -
		after agreeing to another dire warning.
		<p>
		The likely effect of this is that most users will not let local active content run, even if it is only
		mundane JavaScript to run a menu system.
		</p><p>
		The browser is becoming the standard interface for many applications, including those that run locally.
		Many people provide web page information on CD or provide product documentation as web pages.
		In addition many people write and test web pages locally.
		</p><p>
		Although Microsoft have provided two options to enable local content,
		these new security restrictions make life much harder for people who create or view
		content that is used locally.  Most people will not want to reduce their default security settings for
		fear of having their computers corrupted.
		</p><p>
		</p><center>
			<img src="xpsp2_files/xpsp2a.jpg" alt="Information Bar introduction box">
			<br>
			The Information Bar is aptly named - it bars you from viewing information locally...
		</center>
</blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h3>Why are Microsoft doing this?</h3>

	<blockquote>
		We understand that the main problem is online web sites that find security holes so as to be able
		to run code locally.  Code that runs locally used to be able to damage your system.  So - rather than block up the
		security holes - Microsoft have decided to clamp down on all local web page active content so that the user
		has to agree to various dire warnings before letting it run.  
		<p>
		All local web pages (including that on CD) are currently affected.
		There are ways to turn off this security feature (as described below).
		However if turned off to make ordinary local content run, then users are susceptible to the same security holes as before.
		</p><p>
		We also posted a letter to Microsoft UK on 1 July 2004, but to date have had no reply.<br>
We tried to highlight this issue with Microsoft in the SP2 preview
forums - to no avail: the advice was simply to adapt to the new
situation, ie the decision had been made and it was not going to
change. Perhaps Microsoft thinks that the problems are a price worth
paying to make online surfing safe. Or perhaps they have not realised
that many people view content locally. One of our big users in the USA
produces 800,000 CDs every April - the CDs will not run in the default
SP2 settings. We have lost another order because the client could not
tell their users to change their security settings. </p></blockquote>
	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h3>What do Microsoft suggest?</h3>

	<blockquote>
	These seem to be Microsoft's suggestions... but they are not good enough...  (see below for full details)
	<ol>
	<li><a href="#securityoptions">Turn off local machine security</a><br>
		<b>But:</b> We have already had to refund an order because
		<cite>"we don't have control over our end-users machines.  We can't simply tell them to change their settings."</cite>
		<p>
	</p></li><li><a href="#markoftheweb">Give all pages "the Mark of the Web"</a><br>
		<b>But:</b> You cannot seriously expect all pages to have this added.  And links to other file types don't work. 
		<p>
	</p></li><li><a href="#hta">Wrap your application in an HTA file</a><br>
		<b>But:</b> Superficially this isn't too awful a job, but why does the world have to do this?
		(Existing local content will not be fixed.)
	</li></ol>
	Microsoft information pages:
	<br>
	<li><a href="http://msdn.microsoft.com/security/productinfo/xpsp2/securebrowsing/locallockdown.aspx" target="_blank">Local Machine Zone Lockdown</a>
	<br>
	</li><li><a href="http://msdn.microsoft.com/security/productinfo/xpsp2/securebrowsing/lockdown_devimp.aspx" target="_blank">Local Machine Zone Lockdown - Developer Implications</a>
	<br>
	</li><li><a href="http://www.microsoft.com/resources/documentation/ie/6/all/reskit/en-us/appendix.mspx" target="_blank">Internet Explorer 6 Resource Kit: XP SP2 Enhancements to Internet Explorer 6</a> - click on "Local Machine Zone Lockdown"
	<br>
	</li><li><a href="http://www.microsoft.com/windows/ieak/techinfo/deploy/60/en/appendix.mspx" target="_blank">Internet Explorer Administration Kit: XP SP2 Enhancements to Internet Explorer 6</a> - click on "Local Machine Zone Lockdown"
	<br>
	</li><li><a href="http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/sp2brows.mspx" target="_blank">Changes to Functionality in XP SP2: Part 5: Enhanced Browsing Security</a> - click on "Internet Explorer Local Machine Zone Lockdown"

	</li></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
<a name="msdothis"></a>
	<h3>Suggestion 1 for Microsoft</h3>

	<blockquote>
		Come on Microsoft, you can do better than this...
		<p>
		Do the decent thing... block up the security holes... don't ruin locally viewed content.
		</p><p>
		Your current way of solving the problem of malicious "cross-zone access" by making the local zone unusable
		is - need I say it - going to make the local zone unusable.  And yes, there are lots of people
		who provide content to be viewed locally, not just information on CD but product documentation
		and people authoring web content locally before putting it online.
		</p><p>
		The browser is the "interface of choice" for many developers - many applications nowadays that do not
		need an online connection are none-the-less written as web applications.
		These applications will not now work when viewed by an out-of-the-box XP-with-SP2.
	</p></blockquote>

	<h3>Suggestion 2 for Microsoft</h3>

	<blockquote>
		Make the local machine zone equivalent to the Internet zone.
		A lot of pages work fine when viewed online under SP2, but do not work when viewed locally.
		Pre-SP2 the local zone was less restricted than the Internet zone - why make it more restricted in SP2?
	</blockquote>

	<h3>Suggestion 3 for Microsoft</h3>

	<blockquote>
		If you cannot be bothered to handle security properly, then at least make the
		"Allow active content from CDs" option on by default.
	</blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="def"></a>
	<hr>
	<h3>SP2 default security</h3>

	<blockquote>
		As described above, any locally viewed web page that contains active content will be stopped from running.

		<ol>
		<li>At the top of the page in the Information Bar you will see this warning:
			<blockquote>
			<table border="1">
			<tbody><tr><td>
				<i>To help protect your security, Internet Explorer has restricted this file from showing active content
					that could access your computer.  Click here for options...</i>
			</td></tr>
			</tbody></table>
			</blockquote>
			To enable active content, click on this message and then select:
			<blockquote>
			<table border="1">
			<tbody><tr><td>
				<i>Allow Blocked Content...</i>
			</td></tr>
			</tbody></table>
			</blockquote>
			Example showing Internet Explorer trying to run a Java applet locally:
			<p>
			</p><center>
			<img src="xpsp2_files/xpsp2c.jpg" alt="Active content warning for a web page containing a Java applet">
			</center>
			<p>

		</p></li><li>You will also be asked to OK this message:
			<blockquote>
			<table border="1">
			<tbody><tr><td>
				<i>Allowing active content such as script and ActiveX controls can be useful, but active content might also
				harm your computer.
				</i><p>
<i>				Are you sure that you want to let this file run active content?
				</i>
			</p></td></tr>
			</tbody></table>
			</blockquote>
			<br>
			<center>
			<img src="xpsp2_files/xpsp2d.jpg" alt="Enabling active content on Local Machine warning">
			</center>
		</li></ol>

		After all this, the active content should run.
		Note that the active content is only enabled for this Internet Explorer window.
		If you close this window and come back again you will have to go through the same process again.
		However, all further active content in this window is enabled (unless you navigate to non-HTML pages
		such as XML).
	</blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="securityoptions"></a>
	<hr>
	<table>
	<tbody><tr>
	<td valign="top">
		<h3>SP2 new security options</h3>

		<blockquote>
		Microsoft have provided new options to turn off the security on local files to let active content run,
		as shown on the right.
		<p>
		To run active content on all CDs without warnings,
		you must change a security setting in Internet Explorer:
		</p><ul>
		<li>Open menu Tools+Internet Options+Advanced tab
		</li><li>Scroll down to the Security section.
		</li><li>Make sure that "Allow active content from CDs to run on My&nbsp;Computer" is checked.
		</li></ul>
		<p>
		If you want to run active content in all files on your hard disk or similar, then you need to:
		</p><ul>
		<li>Make sure that "Allow active content to run in files on My&nbsp;Computer" is checked.
		</li></ul>
		<p>
		Note: With "Allow active content from CDs" selected, I have found that the Information Bar sometimes still appears saying
		that it has restricted active content, even though the content runs OK.
		</p></blockquote>
	</td>
	<td valign="top">
		<img src="xpsp2_files/xpsp2o.gif" alt="The Internet Explorer Internet Options Advanced options settings needed to run FindinSite-CD">
	</td>
	</tr>
	</tbody></table>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<h3>Are the new security options enough?</h3>

	<blockquote>
		Many people view web content on local files in hard disk and on CD.
		Some will be generating content, while most will simply be viewing content.
		All these people will be affected by SP2.
		<p>
		Are the new security options enough to make these people happy?
		My guess is that the answer is <b>NO</b>.
		</p><p>
		Many people (and their system administrators) will be keen to reduce security intrusions as much as possible.
		Any loosening of the security settings will therefore not be acceptable.
		</p><p>
		One of our customers has already requested a refund on a software licence purchase because
		<cite>"we don't have control over our end-users machines.  We can't simply tell them to change their settings."</cite>
	</p></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="tech"></a>
	<hr>
	<h3>Technical details</h3>

	<blockquote>
	<b>This
section contains registry information - only use if you feel happy
working with the registry editor. Make a backup using File+Export.</b>
	<p>
	The two "Allow active content" security settings are stored in the registry.  Lockdown is ON if the setting is NOT checked.
	</p><p>
	</p><table align="center" border="1" bordercolor="gray" cellpadding="3" cellspacing="0">
	<tbody><tr><td>Registry key/value</td><td>Type</td><td>Lockdown ON</td><td>Lockdown OFF</td></tr>
	<tr>
	<td><code>HKEY_CURRENT_USER\
Software\ Microsoft\ Internet&nbsp;Explorer\ Main\ FeatureControl\
FEATURE_LOCALMACHINE_LOCKDOWN\ iexplore.exe</code>
	</td>
	<td align="center">DWORD</td>
	<td align="center">1</td>
	<td align="center">0</td>
	</tr>
	<tr>
	<td><code>HKEY_CURRENT_USER\
Software\ Microsoft\ Internet&nbsp;Explorer\ Main\ FeatureControl\
FEATURE_LOCALMACHINE_LOCKDOWN\ Settings\ LOCALMACHINE_CD_UNLOCK</code>
	</td>
	<td align="center">DWORD</td>
	<td align="center">0</td>
	<td align="center">1</td>
	</tr>
	</tbody></table>
	<!-- HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_LOCALMACHINE_LOCKDOWN\iexplore.exe DWORD (0 or) 1 -->

	<p>
	Windows uses different "zones" to describe web content, as seen in Tools+Internet Options Security tab,
	ie "Internet", "Local Intranet", "Trusted sites" and "Restricted".  The local "My Computer" zone icon is normally hidden
	(<a href="#enablemycomputer">see below to enable it</a>).
	</p><p>
There are lots of permission values associated with each zone, ie all
the options shown if you click on the "Custom level" button. <br>
	</p><li>Microsoft: <a href="http://msdn.microsoft.com/workshop/security/szone/reference/constants/urlaction.asp" target="_blank">URL Action Flags</a>
	<br>
	</li><li>Microsoft: <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;182569" target="_blank">Description of Internet Explorer security zones registry entries</a>
	<p>
	If Local Machine Lockdown is ON then the "My Computer" permissions are taken from this registry location:<br>
	</p></li><li><code>HKEY_CURRENT_USER\ Software\ Microsoft\ Windows\ CurrentVersion\ Internet&nbsp;Settings\ Lockdown_Zones\0</code>
	<p>
	If Local Machine Lockdown is OFF then the "My Computer" permissions are taken from this registry location:<br>
	</p></li><li><code>HKEY_CURRENT_USER\ Software\ Microsoft\ Windows\ CurrentVersion\ Internet&nbsp;Settings\ Zones\0</code>
	<p>
	The "Allow active content from CDs" setting also switches between these registry locations for web pages on CD.
	</p><p>
	When the "My Computer" zone icon is enabled, setting custom levels only changes the permissions that apply when 
	Local Machine Lockdown is OFF (ie in <code>...\Zones\0</code>).
	You can change the settings for when Local Machine Lockdown is ON, but you can only do this using the registry editor.
	</p><p>
	If Lockdown is ON but you change the zone settings (in <code>...\Lockdown_Zones\0</code>), then an Information Bar warning is shown,
	but the active content is displayed correctly.
	</p></li></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="enablemycomputer"></a>
	<hr>
	<h3>Showing the "My Computer" security zone</h3>

	<blockquote>
	If active content is enabled on My Computer (ie Local Machine Lockdown is OFF) then you might want to adjust the
	permissions, ie actions that can be taken safely.  To make adjustments, you will first have to enable the
	"My Computer" zone icon in the Internet Explorer Tools+Internet Options Security tab.
	<li>Microsoft: <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;315933" target="_blank">How to Enable the My Computer Security Zone in Internet Options</a>
	<p>
	There are two ways to make the "My Computer" zone icon visible:
	</p><ul>
	<li>by clicking on this link - <a href="http://www.phdcc.com/enablemycomputericon.reg">EnableMyComputerIcon.reg</a>
	</li><li>or by changing this registry location from hexadecimal 21 to hexadecimal 47:<br>
		<code>HKEY_CURRENT_USER\ Software\ Microsoft\ Windows\ CurrentVersion\ Internet&nbsp;Settings\ Zones\0\Flags</code><br>
	</li></ul>
	<p>
	Screenshots:
	</p><p>
	</p><center>
	<img src="xpsp2_files/xpsp2i.jpg" alt="When enabled, the 'My Computer' icon appears in Internet Options - Security tab"><br>
	<!--IMG SRC="fiscd/xpsp2j.jpg" ALT="Enabling the 'My Computer' icon manually using the registry editor (regedit)"--><br>
	<img src="xpsp2_files/xpsp2k.jpg" alt="File download security warning"><br>
	<img src="xpsp2_files/xpsp2l.jpg" alt="Registry editor change confirm request" height="129" width="700"><br>
	<img src="xpsp2_files/xpsp2m.jpg" alt="Registry editor change done"><br>
	</center>
	<p>
	Thanks to <a href="http://www.mcweb.com.au/index.php?page=blog&amp;blog=36" target="_blank">Marc Castles and Jetski</a>.
	</p></li></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="markoftheweb"></a>
	<hr>
	<h3>New web pages viewed locally - the "Mark of the Web" solution</h3>

	<blockquote>
		<a target="_blank" href="http://www.microsoft.com/technet/prodtechnol/winxppro/maintain/sp2brows.mspx#xsltsection132121120120">Microsoft documentation</a>
		suggests this as a solution for authors - you must change every single one of your web pages.
		The idea is that you give each web page a "Mark of the Web".
		Then Internet Explorer treats the page as if it were being viewed in the Internet zone.
		<blockquote>
			In an experiment with a few trial web pages, I found that this technique was successful if I remembered
			that every single page has to have "the Mark".  Links from Mark-ed pages to unMark-ed pages silently
			do not work (however hard you click...).  Some sort of indication of the problem would be nice... 
			and an option to go there as well.
			<p>
			A similar problem exists with links to other types of file.  A test HTML file had a link to a PowerPoint
			presentation.  The link did not work if the HTML file had the Mark.  The link still did not work 
			if I set the "Hyperlink Base" for the presentation to match the HTML Mark.  Links to other file types is very
			common on CD so many CDs will fail to run correctly if they are given the Mark.<br>
			(To do: check what happens with PDFs that have been given a matching Base URL.)<br>
			Many types of file do not have the ability to set a Base URL, so they will be unshowable.
			</p><p>
			This technique did make our FindinSite-CD work without any problems.  However - as above - if any result page did not have
			a "Mark of the Web" then FindinSite-CD could not show it.
		</p></blockquote>
		To give a web page a "Mark of the Web" add in "saved from url" comment text at the start of the file.
		There are two possible incantations:
		<ol>
		<li><code>&lt;!-- saved from url=(0014)about:internet --&gt;</code>
		</li><li><code>&lt;!-- saved from url=(0020)http://www.phdcc.com --&gt;</code>
			<p>
			The number in brackets is the length of the string that follows it.
		</p></li></ol>
		<p>
		Microsoft: are you really expecting all the world to add "the Mark" to their pages
		so that they can be viewed offline?
		</p><p>
		Another problem:<br>
		My guess is that a lot of people - like me - write ordinary static web pages locally and test them locally;
		however testing locally is not going to be possible.
		<br>
		What do web editor programs do - do they add in "the Mark"?
	</p></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="hta"></a>
	<hr>
	<h3>Another possible workaround: HTAs (HTML Applications)</h3>

	<blockquote>
		Another suggestion is to use an HTA (HTML Application) wrapper round your local content.
		(<a href="http://msdn.microsoft.com/workshop/author/hta/hta_node_entry.asp" target="_blank">Microsoft documentation of HTAs</a>).
		An HTML Application works exactly like Internet Explorer except that all the
		normal menu and toolbar options are missing - which makes ordinary navigation difficult.
		<p>
		HTML applications are supported by Windows Internet Explorer and Windows Opera but
		not by Windows Navigator/Mozilla.  (Not tested on other platforms yet.)
		</p><p>
		The idea is that you provide one additional file, eg called <code>index.hta</code> that contains the following:
</p><pre><span style="background: pink none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;<font color="green">My HTML Application</font>&lt;/TITLE&gt;
&lt;HTA:APPLICATION ID="oMyApp"
    BORDER="thin"
    INNERBORDER="no"
    SCROLL="no"
    CAPTION="yes"
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    WINDOWSTATE="normal"&gt;
&lt;STYLE&gt; body {margin:0} &lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;IFRAME src="<font color="green">index.htm</font>" application=yes width="100%"
	height=100% marginwidth=0 marginheight=0
	frameborder=0&gt;Iframes not supported&lt;/IFRAME&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</span></pre>

		Set the green text to an application title and your start web page.
		<p>
		The final job is get Windows Internet Explorer users to view the <code>index.hta</code>,
		eg by providing a shortcut to it, or setting AutoRun to start it.
		The shortcut or AutoRun may not work if another browser is the default browser.
		</p><p>
		Further information I have been told:
		</p><li>The "saved from" comment can be put anywhere in the file
		</li><li>You can use frames in the HTA instead of IFRAME if your application already uses frames.
			Depending on the web application, it may be necessary to add APPLICATION="yes" to all/some FRAME tags.
		</li><li>If an HTA opens another window then this windows does not inherit the "application=yes" trusted status.
	</li></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="dyncd"></a>
	<hr>
	<h3>Another possible workaround: Use Dynamic-CD</h3>

	<blockquote>
	Another possible workaround is to use our 
	<a class="menu" href="http://www.phdcc.com/dynamic-cd/" target="_blank">Dynamic-CD</a> Windows software.
	This is an internet web server that can be put on CD or run anywhere locally.
	<p>
	If used on a CD or DVD, Dynamic-CD AutoRuns when inserted into a Windows computer.  Dynamic-CD starts the default browser
	to display a start page at eg <span style="background: pink none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><code>http://127.0.0.1:8080/default.asp</code></span>.
	Dynamic-CD itself serves the pages, getting the data from the CD.
	The <span style="background: pink none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><code>127.0.0.1</code></span>. address is usually deemed by Internet Explorer
	to be Intranet Zone, and will therefore allow most content to run.
	</p><p>
	Dynamic-CD only runs in Windows.  However Local Machine Lockdown is a problem only for Windows Internet Explorer,
	so users of other platforms can view the content normally.
	</p><p>
	We may be able to offer a cut down
	version of Dynamic-CD that just serves CD content - <a class="menu" href="mailto:sales@phdcc.com">email sales/support</a> if
	interested.
	</p></blockquote>

	<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->
	<a name="otherbrowsers"></a>
	<hr>
	<h3>Another possible workaround: Use other browsers</h3>

	<blockquote>
	If you are just viewing or developing pages yourself locally and do not expect others to view them locally, then
	a simple solution is to use another browser.  It is sensible anyway to check that your pages are viewable in other browsers.
	<p>
	A variant on this approach is to view your pages locally through a local web server, such as IIS, Apache or Dynamic-CD.
	</p></blockquote>


<!--++++++++++++++++++++++++++++++++++++++++++++++++++-->

<hr>

<a name="comments"></a>
<h3>Comments:</h3>

<font size="-1">(We received many earlier comments by email. However
the comment form for posting online was not provided so we cannot list
them.)</font>
<dl>
<dt><b>Manuel, Italy, Sun, 12 Jun 2005 09:12:33 (GMT)</b></dt>
<dd><i>Great advice on this issue! I've been knocking my head on the PC
for days, sysadmin had no idea on it. Thank you very much for these
infos, hope MS will fix it up soon. <br>
Regards, Manuel </i>
	<p>

</p></dd><dt><b>John E Colman, Sun, 26 Jun 2005 22:34:17 (GMT)</b></dt>
<dd><i>Some great tips here I hadn't found elsewhere.  I hope that others also stumble onto your site.</i>
	<p>

</p></dd><dt><b>Graham, Sun, 03 Jul 2005 09:36:21 (GMT)</b></dt>
<dd><i>I'm glad I found your site, some good tips available. I think
microsoft will have to retract this security issue sooner or later, as
most marketing catalogues will eventually be produced on CD. We need to
lobby them relentlessly.</i>
	<p>

</p></dd><dt><b>arul, Mon, 04 Jul 2005 16:55:43 (GMT)</b></dt>
<dd><i>I've been unable to run JavaScript on my IE6 (winXP). Now I have
a clearer picture. Thanks a lot for this page. Keep up the good work!</i>
	<p>

</p></dd><dt><b>Martin Modin, Thu, 14 Jul 2005 21:19:37 (GMT)</b></dt>
<dd><i>This is great information. I hope it's OK that I blogged about
this "http://tinyurl.com/7oboq" if not let me know and I'll remove it.</i>
	<p>

</p></dd><dt><b>Peter Zelei, Mon, 25 Jul 2005 13:28:42 (GMT)</b></dt>
<dd><i>you saved my life... thank you very much</i>
	<p>

</p></dd><dt><b>amit, Fri, 29 Jul 2005 14:17:36 (GMT)</b></dt>
<dd><i>thanx gratefully</i>
	<p>

</p></dd><dt><b>Ed, Tue, 02 Aug 2005 14:35:15 (GMT)</b></dt>
<dd><i>Another workaround - Use Desktop Explorer to map a drive letter to a folder (like My Web) on the C: Drive
	and use the path to that drive to open the files. The only trick is the path must be in the format:
	\\<code>PCIdentity</code>\C$\PATH. When files are opened with the new drive letter, they are treated as if they are not on the local drive.
	</i><p>
<i>	For my browser home page, I have a web page with lots of
	pull-down menus using scripts that automatically go to the selection
	when you release the mouse button. Those simple scripts were "flagged"
	as suspect and I was not willing to right-mouse-click and over-ride
	every time I launched a browser window. I first tried placing the file
	on a company file server that was mapped to another drive letter and it
	didn't come up with any alerts. So the next step was to assign a drive
	letter to the folder where my files are and that worked. 
	</i>
	</p><p>

</p></dd><dt><b>big boy, Wed, 10 Aug 2005 10:02:47 (GMT)</b></dt>
<dd><i>I was at a loss to figure out what was going, why didn't
microsoft have the decency to imform me about this problem, I have
spent money on stuff I had been reading for months then suddenly I
began to get this content message, now I can't continue this net course
that cost me good money until microsoft fixes this problem, I tried
going through the steps but still I can't seem to figure it out, guess
I'll just have to keep trying or wait for MS to get their shite
together !</i>
	<p>

</p></dd><dt><b>davidb, Wed, 10 Aug 2005 16:13:24 (GMT)</b></dt>
<dd><i>As a technical writer, this was an incredibly frustrating set of
issues to learn about. I now have a process whereby I have to manually
add the 'mark of the web' to every HTML page I create for HTML Help.
And my company had to change our products' installation procedures by
adding an appropriate registry entry so that HTML Help can be read from
CD or any mapped drive other than C: - <br>
<code>[HKEY_LOCAL_MACHINE\ SOFTWARE\ Microsoft\ HTMLHelp\1.x\ItssRestrictions] "MaxAllowedZone"=dword:00000001</code>
</i>
<br>
Microsoft KB 896054: <a href="http://support.microsoft.com/kb/896054">You cannot open remote content by using the InfoTech protocol</a>
	<p>


</p></dd><dt><b>Peter Zaremba, Sat, 03 Sep 2005 19:50:55 (GMT)</b></dt>
<dd><i>Thanks for creating this page. I was going crazy trying to
figure out a work around for active content run locally. After reading
your page I have a couple of ideas. Thanks again.
</i>
	<p>


</p></dd><dt><b>Bill Claxton, Tue, 06 Sep 2005 08:54:08 (GMT)</b></dt>
<dd><i>Ed, thank you so much!  I've tried the HTA route and don't much like it -
for one thing, the application environment doesn't look like a standard browser window.
</i><p>
<i>The best approach is your tip, which not only works, it requires changing only the startup - 
no web content needs to change at all.  I customized my startup script to detect XP and handle other potential problems. 
Following is the result.  
</i></p><p>
<i>Normally I run an HTML page 'index_cd.htm' when the CD starts.  
Now I launch this batch script in my 'autorun.inf' (using 'start /min  share_cd.bat'), and it works marvellously.
</i>

<code>@echo off<br>
:detection<br>
ver | find /i "Windows XP" &gt; nul <br>
if not errorlevel 1 goto share_drive<br>
start index_cd.htm<br>
goto end<br>
<br>
:share_drive<br>
if "%computername%" == "" goto err1<br>
net share cd_rom /d<br>for
%%d in (c d e f g h i j k l m n o p q r s t u w x y z) do if exist
%%d:\share_cd.bat net share cd_rom=%%d:\ /users:1 /r:"This CD-ROM is
temporarily shared."<br>
if errorlevel 3 goto err2<br>
start \\%computername%\cd_rom\index_cd.htm<br>
goto end<br>
<br>
:err1<br>
echo Error - unable to locate 'computername' environment variable.<br>
goto end<br>
<br>
:err2<br>
echo Error - unable to share CD as a network drive. This action requires Win2000 or WinXP.<br>
goto end<br>
<br>
:end<br>
echo.<br>
echo Program completed successfully.</code>
	</p><p>
Addendum:  While 'start' can be used in the batch file, it fails in the 'autorun.inf' on XP and Win2000.  
All along I've been using 'shellexecute', but I wanted the batch script to run in minimized mode.  
Fortunately I found a new shareware 'shellexecute' that supports running batch files in minimized mode:
<a rel="nofollow" href="http://www.optimumx.com/download/#shellexecute">ShellExecute</a>
</p><p>
The syntax for the autorun file using this utility is: "open=shellexecute /f:share_cd.bat /r:min".
</p><p>
ShellExecute launches the batch file properly in XP, and using the
'minimize' option you can eliminate the annoying 'DOS box flash'.
</p><p>
<i>[Editor's note: phdcc's retail <a href="http://www.phdcc.com/shellrun/">ShellRun</a> software can also launch a batch file in a minimised DOS box]</i>
</p><p>


</p></dd><dt><b>elviejo, Sat, 24 Sep 2005 18:30:22 (GMT)</b></dt>
<dd><i>Also I had small javascript and I want to test it.
So every time I opened explorer to test it will opene the "Informative
Bar" to tell me that this was dynamic content. So I had to tell it that
I really wanted to open it.
<br>But the most annoying, yes there is more, is that when ever I
changed the local webpage to debug it, Explorer closed by itself, as
simple as that you change a local webpage, explorer closes.
<br>
This for a hand made webdeveloper is totally unacceptable, arggh!</i>
	<p>


</p></dd><dt><b>Christopher Hill, Thu, 29 Sep 2005 12:55:23 (GMT)</b></dt>
<dd><i>Re the comments from Ed and Bill Claxton about sharing the CD
drive and connecting to it to fix the problem. If you do this you are
opening up a whole can of worms because it means that anyone on your
network can view the contents of your CD drive. So if you put a CD with
confidential information on anyone can see what it is on it!
Additionally, if you're not running as Administrator or Power Users on
your workstation (which many corporate and educational users won't be)
you won't be able to share the drive anyway, so it won't work.
<br>
In short - it's a bad idea! Don't do it!
</i>
	<p>


</p></dd><dt><b>brian, Sat, 01 Oct 2005 18:28:55 (GMT)</b></dt>
<dd><i>wow all this info, for the most of us including me we dont
understand half of it,if any of it, i am not thick i use html and java
script for making web pages, but i do know that the blocked content
popup box is a right pain microsoft should give us a facilty to turn it
off. <br>
come on microsoft you are dealing with normal people here we aren't all computer engineers you know</i>
	<p>


</p></dd><dt><b>Stacey, Wed, 05 Oct 2005 12:14:21 (GMT)</b></dt>
<dd><i>This page was so helpful!&nbsp; I couldn't figure out why my
users were getting the security message but I have a clear
understanding now.&nbsp; Thanks.</i>
	<p>


</p></dd><dt><b>Paul Baker, Tue, 18 Oct 2005 20:27:09 (GMT)</b></dt>
<dd><i>Although the mark of the web sorts my problem for htm(l) pages,
if I save the page as a web archive (mht) the mark is not respected in
the resulting mht file. This is despite Microsoft's assurances to the
contrary. What seems to happen is that the html is "re-formatted" when
the save occurs and the MOTW comment is no longer on its own line but
instead shares a line with, say, a tag. Whether this is the problem or
not, the MOTW is certainly ineffective in the mht file.
</i>
	<p>


</p></dd><dt><b>Mario Schmalzl, Fri, 21 Oct 2005 17:02:44 (GMT)</b></dt>
<dd><i>Great approach, but still it doesn't work, if the zone cannot be defined clearly.
<br>
For so called "mixed zones" Sites (as in MS-CRM 3.0) you cannot assign a site and/or set security permissions.
<br>
Anyone an idea on that?</i>
	<p>


</p></dd><dt><b>stephen harris, Tue, 25 Oct 2005 16:32:11 (GMT)</b></dt>
<dd><i>Thank you, very useful and helpful suggestions, I have designed
a few medical calculation web pages for distribution to clinicians who
cannot access the Hospital Intranet. Most are using Win 2k, but a few
are using XP. I will need to experiment to see which is the best
option.
</i>
	<p>


</p></dd><dt><b>Iris, Thu, 03 Nov 2005 23:23:49 (GMT)</b></dt>
<dd><i>This is great info. I have a puzzling scenario though. None - I
mean absolutely none - of may applications can open help at all. When I
try to open chm files directly, it cannot open
mk:@MSITStore:C:\pathto\filename.
I have regsitered the hlpctrl.ocx, as advise somewhere else. I have
tried to enale the ms-its protocol, no luck. All the help files are on
my local machine and the apps run locally, so I shouldn't have this
issue. Right?
<br>
Any insight would be greatly appreciated!!

</i>
	<p>


</p></dd><dt><b>Nick, Fri, 18 Nov 2005 00:26:20 (GMT)</b></dt>
<dd><i>Thankyou very much - The HTA work around worked for my CD</i>
	<p>


</p></dd><dt><b>Alex Garcia, Wed, 30 Nov 2005 17:32:10 (GMT)</b></dt>
<dd><i>This is great info. Thank you...</i>
	<p>


</p></dd><dt><b>Tony, Fri, 02 Dec 2005 05:37:30 (GMT)</b></dt>
<dd><i>The Dynamic-CD program works great. Other than disabling
security -- which is not something I think prospective customers would
be interested in doing -- nothing else seemed to work when linking to
PDF documents. Thank you for this fantastic recourse!</i>
	<p>


</p></dd><dt><b>Cheong, ganpuzzle, Thu, 12 Jan 2006 01:27:39 (GMT)</b></dt>
<dd><i>Excellent article. We should all revolt against MS. I am
seriously affected because I sell java applet puzzles. Guess what,
lately I have a few requests for refund thinking that it is my software
that is faulty. Microsoft is trying to kill Java applet, that is for
sure.
<br>
Do I have a legal case against Microsoft for preventing me from making a living?
</i>
	<p>


</p></dd><dt><b>Michael Hall, Sat, 21 Jan 2006 00:34:11 (GMT)</b></dt>
<dd><i>I have built a multimedia app in .html. I have put the generic MOTW on every page. 
The app works in IE with XP SP 2(in Internet Zone) but, the apps performance is so slow it is almost not usable. 
I have found however, that if I establish a connection to the internet (while running the app locally) 
then the apps performance is greatly improved. Can you explain why performance is improved by connecting to the internet 
and also if there are any additional workarounds I can try?
</i>
	<p>


</p></dd><dt><b>John Page, Fri, 3 Feb 2006 11:20:43 -0700</b></dt>
<dd><i>Good stuff.  I am using the Mark of the Web solution, but a couple of comments:
</i><ol><li><i>It does not appear to verify the url in the tag. I have
found you can put any garbage (non-existent) url there and it still
works so long as the byte count is OK.
</i></li><li><i>In that case, what is to stop a malicious coder putting any mark in their code?</i></li></ol>


	<p>


</p></dd><dt><b>Hans, Sun, 12 Feb 2006 11:37:10 (GMT)</b></dt>
<dd><i>Thanx for sharing knowledge regarding sp2 security. It was definately worth the time reading this page.
</i>
	<p>


</p></dd></dl>

<span class="noprint">
	<table border="1" bordercolor="#993333" cellpadding="3" cellspacing="0">
	<tbody><tr>
	<td>
		<form method="post" action="http://www.phdcc.com/addcomment.asp" style="">
		<input name="toemail" value="chris@phdcc.com" type="hidden">
		<input name="page" value="xpsp2.htm" type="hidden">
		
		<table>
		<tbody><tr>
			<td valign="top">Name:&nbsp;</td>
			<td><input style="background-color: rgb(255, 255, 160);" name="name" size="30" maxlength="80" type="text"></td>
		</tr>
		<tr>
			<td valign="top">Email:&nbsp;</td>
			<td><input style="background-color: rgb(255, 255, 160);" name="fromemail" size="30" maxlength="80" type="text"></td>
		</tr>
		<tr>
			<td valign="top">Comment:&nbsp;</td>
			<td><textarea name="comment" rows="5" cols="50"></textarea></td>
		</tr>
		<tr>
			<td></td>
			<td><input name="post" value="Post comment" type="submit">
				<input name="email" value="Send email - not for posting" type="submit">
			</td>
		</tr>
		</tbody></table>
		</form>
	</td>
	</tr>
	</tbody></table>
	<p>
	Comments will be moderated before posting.
	</p>

</span>


			<!-- Page content end -->

		</td>
		<!-- Big face image on right -->
		<!--td width="280" align="right" valign="top" CLASS=noprint>
			<img src="images/homeimage.jpg" alt="phdcc: e-media tools and e-publishing services for CDs, DVDs and the Web" width="280" height="362">
		</td-->
		</tr>
		</tbody></table>
	</div>
</td>
</tr>

<!-- Row for footer blocks -->
<tr class="noprint">
<td align="center" height="104" valign="top">
	<table class="bottomTable" border="0" cellpadding="0" cellspacing="0" height="104" width="95%">
	<!-- fis-ms block -->
	<tbody><tr align="center" valign="middle">
	<td>
		<table xwidth="155" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
		<td align="left" height="43" valign="top"><a href="http://www.phdcc.com/findinsite/"><img src="xpsp2_files/logofindms.jpg" alt="FindInSite-ms: Search engine for ASP.NET" border="0" height="33" width="230"></a></td>
		</tr>
		<tr>
		<td class="logoText" align="left" height="37" valign="top">Search engine for ASP.NET<br>
			<a href="http://www.phdcc.com/findinsite/" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('LearnImageFISMS','','images/learn_hi.gif',1)"><img src="xpsp2_files/learn.gif" alt="Click here to learn more about findinsite-ms" name="LearnImageFISMS" id="LearnImageFISMS" border="0" height="12" width="60"></a></td>
		</tr>
		</tbody></table>
	</td>
	<td width="3"><img src="xpsp2_files/divider1.gif" height="66" width="1"></td>

	<!-- fis-cd block -->
	<td>
		<table xwidth="155" border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
		<td align="left" height="43" valign="top"><a href="http://www.phdcc.com/fiscd/"><img src="xpsp2_files/logofindcd.jpg" alt="FindInSite-cd: Search engine for CD and DVD" border="0" height="33" width="221"></a></td>
		</tr>
		<tr>
		<td class="logoText" align="left" height="37" valign="top">Search engine for CD and DVD<br>
			<a href="http://www.phdcc.com/fiscd/" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('LearnImageFISCD','','images/learn_hi.gif',1)"><img src="xpsp2_files/learn.gif" alt="Click here to learn more about findinsite-cd" name="LearnImageFISCD" id="LearnImageFISCD" border="0" height="12" width="60"></a></td>
		</tr>
		</tbody></table>
	</td>
	<td width="3"><img src="xpsp2_files/divider1.gif" height="66" width="1"></td>

	<!-- dyncd block -->
	<td>
		<table border="0" cellpadding="0" cellspacing="0" width="135">
		<tbody><tr>
		<td align="left" height="43" valign="top"><a href="http://www.phdcc.com/dynamic-cd/"><img src="xpsp2_files/logodynamic.jpg" alt="dynamic-cd: database/ASP web server on CD and DVD" border="0" height="35" width="203"></a></td>
		</tr>
		<tr>
		<td class="logoText" align="left" height="37" valign="top">database/ASP web server on CD and DVD<br>
		<a href="http://www.phdcc.com/dynamic-cd/" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('LearnImageDYNCD','','images/learn_hi.gif',1)"><img src="xpsp2_files/learn.gif" alt="Click here to learn more about dynamic-cd" name="LearnImageDYNCD" id="LearnImageDYNCD" border="0" height="12" width="60"></a></td>
		</tr>
		</tbody></table>
	</td>
	</tr>
	</tbody></table>
</td>
</tr>

<!-- Row for footer text -->
<tr>
<td align="left" height="33" valign="top">
	<table class="bottomTile" border="0" cellpadding="0" cellspacing="0" width="100%">
	<tbody><tr>
	<td height="33" width="32">&nbsp;</td>
	<td xwidth="410" class="bottomtext" align="left" height="33" valign="top">All site Copyright © 1996-2006 <a href="http://www.phdcc.com/" class="bottom">PHD Computer Consultants Ltd, PHDCC</a></td>
	<td height="33">&nbsp;</td>
	<td xwidth="60" align="right" height="33" valign="top"><a href="http://www.phdcc.com/privacy.htm" class="bottom">Privacy</a></td>
	<td height="33" width="32">&nbsp;</td>
	</tr>
	</tbody></table>
</td>
</tr>
</tbody></table>

<!--
http://www.mcweb.com.au/index.php?page=blog&blog=36
http://weblogs.asp.net/jgalloway/archive/2004/08/20/218123.aspx
http://groups.yahoo.com/group/HATT/message/52323
http://weblogs.asp.net/jgalloway/archive/2004/08/04/208072.aspx
http://www.dslreports.com/forum/remark,11129306~mode=flat

typedef enum {
    ZAFLAGS_CUSTOM_EDIT = 0x00000001,
    ZAFLAGS_ADD_SITES = 0x00000002,
    ZAFLAGS_REQUIRE_VERIFICATION = 0x00000004,
    ZAFLAGS_INCLUDE_PROXY_OVERRIDE = 0x00000008,
    ZAFLAGS_INCLUDE_INTRANET_SITES = 0x00000010,
    ZAFLAGS_NO_UI = 0x00000020,
    ZAFLAGS_SUPPORTS_VERIFICATION = 0x00000040,
    ZAFLAGS_UNC_AS_INTRANET = 0x00000080
ZAFLAGS_USE_LOCKED_ZONES 
} ZAFLAGS;


LMZspycd.cpp:	Lockdown_Zones\0
// Set URLACTION_HTML_JAVA_RUN  "1C00" to 0x10000 to let Java run (High Safety) - if Java currently disabled
// Set URLACTION_ACTIVEX_RUN "1400" to 0 to let scripts run

1400	Active scripting	"Enable"=0x00000000 
							"Disable"=0x00000003 
							"Prompt"=0x00000001



1C00	Java permissions	"High safety"=0x00010000
							"Medium safety"=0x00020000
							"Low safety"=0x00030000
							"Custom"=0x00800000
							"Disable Java"=0x00000000

-->
</body></html>